<!doctype html>
<html lang='en'>
<head>
  <!-- FixIt QC Marketing Site v7.0 • Built 2025-10-29 -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
  <title>Admin Console — FixIt QC</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/site.css" />
  
  <!-- IMMEDIATE AUTH WALL - Hide everything until authenticated -->
  <style>
    /* Hide admin content by default */
    #adminContent {
      display: none;
    }
    
    /* Auth wall styling */
    #authWall {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background: var(--bg);
      padding: 20px;
    }
    
    #authWall .wall-content {
      text-align: center;
      max-width: 500px;
      padding: 60px 40px;
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 24px;
      backdrop-filter: blur(20px);
    }
    
    #authWall .lock-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 24px;
      padding: 20px;
      background: rgba(236, 156, 66, 0.1);
      border-radius: 50%;
      border: 2px solid var(--copper);
    }
    
    #authWall .lock-icon svg {
      width: 100%;
      height: 100%;
      stroke: var(--copper);
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    
    #authWall h1 {
      font-size: 2rem;
      margin-bottom: 16px;
      color: var(--text);
    }
    
    #authWall p {
      color: var(--muted);
      margin-bottom: 32px;
      line-height: 1.6;
    }
    
    #authWall .btn-login {
      display: inline-block;
      padding: 14px 32px;
      background: var(--copper);
      color: var(--bg);
      text-decoration: none;
      border-radius: 12px;
      font-weight: 600;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      font-size: 1rem;
    }
    
    #authWall .btn-login:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(236, 156, 66, 0.4);
    }
    
    #authWall .loading {
      color: var(--muted);
      font-size: 0.9rem;
      margin-top: 20px;
    }
    
    #authWall .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(236, 156, 66, 0.2);
      border-top-color: var(--copper);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin-right: 8px;
      vertical-align: middle;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
  
  <script type="module" src="assets/js/admin.mjs"></script>
</head>
<body>
  
  <!-- AUTH WALL - Shown until authenticated -->
  <div id="authWall">
    <div class="wall-content">
      <div class="lock-icon">
        <svg viewBox="0 0 24 24">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
        </svg>
      </div>
      <h1>Authentication Required</h1>
      <p id="authMessage">Checking authentication...</p>
      <div class="loading" id="authLoading">
        <span class="spinner"></span>
        Verifying credentials...
      </div>
      <div id="authActions" style="display: none;">
        <a href="login.html" class="btn-login">Sign In to Continue</a>
        <p style="margin-top: 20px; font-size: 0.9rem;">
          Don't have access? Contact your administrator.
        </p>
      </div>
    </div>
  </div>

  <!-- ADMIN CONTENT - Hidden until authenticated -->
  <div id="adminContent">
  <header class="nav">
    <a class="brand" href="index.html">
      <img src="assets/img/fixitqc-logo.png" alt="FixIt QC" class="logo" />
    </a>
    <button id="hamburger" aria-label="Menu" aria-expanded="false">
      <span class="bar"></span>
      <span class="bar"></span>
    </button>

    <!-- Cascade overlay menu -->
    <div id="cascade" class="cascade mini">
      <a class="mini-card" href="index.html">
        <span class="ico">
          <svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
        </span>
        <span>Home</span>
      </a>
      <a class="mini-card" href="features.html">
        <span class="ico">
          <svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>
        </span>
        <span>Features</span>
      </a>
      <a class="mini-card" href="screenshots.html">
        <span class="ico">
          <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
        </span>
        <span>Screenshots</span>
      </a>
      <a class="mini-card" href="pricing.html">
        <span class="ico">
          <svg viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
        </span>
        <span>Pricing</span>
      </a>
      <a class="mini-card" href="admin.html">
        <span class="ico">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M12 1v6m0 6v6m9-9h-6m-6 0H3m15.364 6.364l-4.243-4.243m-6.364 0L3.636 19.364M19.364 4.636l-4.243 4.243m-6.364 0L4.636 4.636"></path></svg>
        </span>
        <span>Admin</span>
      </a>
      <a class="mini-card" href="contact.html">
        <span class="ico">
          <svg viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
        </span>
        <span>Contact</span>
      </a>
      <button id="logoutBtn" class="mini-card logout-btn" style="background: rgba(236,66,66,0.2); border-color: rgba(236,66,66,0.4);">
        <span class="ico">
          <svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
        </span>
        <span>Logout</span>
      </button>
    </div>
  </header>

  <section class="pagehead">
    <h2>Admin Console</h2>
    <p class="sub">Manage users, organizations, stations, equipment, and system settings.</p>
  </section>

  <section class="panel glass">
    <div id="authLoader" style="text-align: center; padding: 40px; color: var(--muted);">
      <p style="margin-bottom: 16px;">⚡ Loading admin panel...</p>
      <p style="font-size: 0.9rem;">If this takes more than a few seconds, you may need to <a href="login.html" style="color: var(--copper);">sign in</a>.</p>
    </div>
    
    <div id="adminContent" style="display: none;">
      <h3 style="margin-bottom: 8px;">Welcome, <span id="userEmail" style="color: var(--copper);">Admin</span></h3>
      <p style="color: var(--muted); margin-bottom: 28px;">Manage your FixIt QC deployment from this console.</p>
      
      <!-- Quick Stats -->
      <div class="admin-section">
        <h4>Quick Stats</h4>
        <div class="grid" style="margin-top: 12px;">
          <div class="glass" style="padding: 20px; text-align: center;">
            <div style="font-size: 2rem; font-weight: 800; color: var(--copper);" id="totalOrganizations">0</div>
            <div style="color: var(--muted);">Organizations</div>
          </div>
          <div class="glass" style="padding: 20px; text-align: center;">
            <div style="font-size: 2rem; font-weight: 800; color: var(--copper);" id="totalStations">0</div>
            <div style="color: var(--muted);">Stations</div>
          </div>
          <div class="glass" style="padding: 20px; text-align: center;">
            <div style="font-size: 2rem; font-weight: 800; color: var(--copper);" id="totalUsers">0</div>
            <div style="color: var(--muted);">Total Users</div>
          </div>
          <div class="glass" style="padding: 20px; text-align: center;">
            <div style="font-size: 2rem; font-weight: 800; color: var(--copper);" id="totalEquipment">0</div>
            <div style="color: var(--muted);">Equipment Items</div>
          </div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="admin-section" style="margin-top: 40px;">
        <div class="tabs">
          <button class="tab active" data-tab="organizations">Organizations</button>
          <button class="tab" data-tab="stations">Stations</button>
          <button class="tab" data-tab="users">Users</button>
          <button class="tab" data-tab="equipment">Equipment</button>
        </div>

        <!-- Organizations Tab -->
        <div id="organizations-content" class="tab-content active">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h4 style="margin: 0;">Organization Management</h4>
            <button class="btn primary" onclick="showAddOrganizationModal()">
              <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14m-7-7h14"></path>
              </svg>
              Add Organization
            </button>
          </div>
          
          <div class="glass" style="overflow-x: auto;">
            <table class="admin-table" id="organizationsTable">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Stations</th>
                  <th>Users</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Organizations will be populated here by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Stations Tab -->
        <div id="stations-content" class="tab-content">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h4 style="margin: 0;">Station Management</h4>
            <button class="btn primary" onclick="showAddStationModal()">
              <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14m-7-7h14"></path>
              </svg>
              Add Station
            </button>
          </div>
          
          <div class="glass" style="overflow-x: auto;">
            <table class="admin-table" id="stationsTable">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Code</th>
                  <th>Organization</th>
                  <th>Equipment Count</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Stations will be populated here by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Users Tab -->
        <div id="users-content" class="tab-content">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h4 style="margin: 0;">User Management</h4>
            <button class="btn primary" onclick="showAddUserModal()">
              <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14m-7-7h14"></path>
              </svg>
              Add User
            </button>
          </div>
          
          <div class="glass" style="overflow-x: auto;">
            <table class="admin-table" id="usersTable">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Role</th>
                  <th>Station</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Users will be populated here by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Equipment Tab -->
        <div id="equipment-content" class="tab-content">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h4 style="margin: 0;">Equipment Management</h4>
            <button class="btn primary" onclick="showAddEquipmentModal()">
              <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14m-7-7h14"></path>
              </svg>
              Add Equipment
            </button>
          </div>
          
          <div class="glass" style="overflow-x: auto;">
            <table class="admin-table" id="equipmentTable">
              <thead>
                <tr>
                  <th>Equipment ID</th>
                  <th>Type</th>
                  <th>Location</th>
                  <th>Status</th>
                  <th>Last Service</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Equipment will be populated here by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Add Organization Modal -->
  <div id="addOrganizationModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Add Organization</h3>
        <button class="close-btn" onclick="closeModal('addOrganizationModal')">&times;</button>
      </div>
      <form id="addOrganizationForm">
        <label>
          <span>Organization Name *</span>
          <input type="text" id="newOrganizationName" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Contact Email</span>
          <input type="email" id="newOrganizationContact" />
        </label>
        <label style="margin-top: 16px;">
          <span>Phone</span>
          <input type="tel" id="newOrganizationPhone" />
        </label>
        <div class="modal-actions">
          <button type="button" class="btn" onclick="closeModal('addOrganizationModal')">Cancel</button>
          <button type="submit" class="btn primary">Add Organization</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Organization Modal -->
  <div id="editOrganizationModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Edit Organization</h3>
        <button class="close-btn" onclick="closeModal('editOrganizationModal')">&times;</button>
      </div>
      <form id="editOrganizationForm">
        <input type="hidden" id="editOrganizationId" />
        <label>
          <span>Organization Name *</span>
          <input type="text" id="editOrganizationName" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Contact Email</span>
          <input type="email" id="editOrganizationContact" />
        </label>
        <label style="margin-top: 16px;">
          <span>Phone</span>
          <input type="tel" id="editOrganizationPhone" />
        </label>
        <div class="modal-actions">
          <button type="button" class="btn" onclick="closeModal('editOrganizationModal')">Cancel</button>
          <button type="submit" class="btn primary">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Station Modal -->
  <div id="addStationModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Add Station</h3>
        <button class="close-btn" onclick="closeModal('addStationModal')">&times;</button>
      </div>
      <form id="addStationForm">
        <label>
          <span>Station Name *</span>
          <input type="text" id="newStationName" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Station Code</span>
          <input type="text" id="newStationCode" placeholder="e.g. LAX, JFK" />
        </label>
        <label style="margin-top: 16px;">
          <span>Location</span>
          <input type="text" id="newStationLocation" placeholder="City, State" />
        </label>
        <label style="margin-top: 16px;">
          <span>Organization *</span>
          <select id="newStationOrganization" required>
            <option value="">Select Organization</option>
          </select>
        </label>
        <div class="modal-actions">
          <button type="button" class="btn" onclick="closeModal('addStationModal')">Cancel</button>
          <button type="submit" class="btn primary">Add Station</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Station Modal -->
  <div id="editStationModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Edit Station</h3>
        <button class="close-btn" onclick="closeModal('editStationModal')">&times;</button>
      </div>
      <form id="editStationForm">
        <input type="hidden" id="editStationId" />
        <label>
          <span>Station Name *</span>
          <input type="text" id="editStationName" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Station Code</span>
          <input type="text" id="editStationCode" />
        </label>
        <label style="margin-top: 16px;">
          <span>Location</span>
          <input type="text" id="editStationLocation" />
        </label>
        <label style="margin-top: 16px;">
          <span>Organization *</span>
          <select id="editStationOrganization" required>
            <option value="">Select Organization</option>
          </select>
        </label>
        <div class="modal-actions">
          <button type="button" class="btn" onclick="closeModal('editStationModal')">Cancel</button>
          <button type="submit" class="btn primary">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add User Modal -->
  <div id="addUserModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Add User</h3>
        <button class="close-btn" onclick="closeModal('addUserModal')">&times;</button>
      </div>
      <form id="addUserForm">
        <label>
          <span>Name *</span>
          <input type="text" id="newUserName" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Email *</span>
          <input type="email" id="newUserEmail" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Password *</span>
          <input type="password" id="newUserPassword" required minlength="6" />
        </label>
        <label style="margin-top: 16px;">
          <span>Role *</span>
          <select id="newUserRole" required>
            <option value="user">User</option>
            <option value="tech">Technician</option>
            <option value="localAdmin">Local Admin</option>
            <option value="globalAdmin">Global Admin</option>
          </select>
        </label>
        <label style="margin-top: 16px;">
          <span>Organization</span>
          <select id="newUserOrganization">
            <option value="">Select Organization</option>
          </select>
        </label>
        <label style="margin-top: 16px;">
          <span>Station</span>
          <select id="newUserStation">
            <option value="">Select Station</option>
          </select>
        </label>
        <div class="modal-actions">
          <button type="button" class="btn" onclick="closeModal('addUserModal')">Cancel</button>
          <button type="submit" class="btn primary">Add User</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit User Modal -->
  <div id="editUserModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Edit User</h3>
        <button class="close-btn" onclick="closeModal('editUserModal')">&times;</button>
      </div>
      <form id="editUserForm">
        <input type="hidden" id="editUserId" />
        <label>
          <span>Name *</span>
          <input type="text" id="editUserName" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Email *</span>
          <input type="email" id="editUserEmail" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Role *</span>
          <select id="editUserRole" required>
            <option value="user">User</option>
            <option value="tech">Technician</option>
            <option value="localAdmin">Local Admin</option>
            <option value="globalAdmin">Global Admin</option>
          </select>
        </label>
        <label style="margin-top: 16px;">
          <span>Organization</span>
          <select id="editUserOrganization">
            <option value="">Select Organization</option>
          </select>
        </label>
        <label style="margin-top: 16px;">
          <span>Station</span>
          <select id="editUserStation">
            <option value="">Select Station</option>
          </select>
        </label>
        <div class="modal-actions">
          <button type="button" class="btn" onclick="closeModal('editUserModal')">Cancel</button>
          <button type="submit" class="btn primary">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Equipment Modal -->
  <div id="addEquipmentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Add Equipment</h3>
        <button class="close-btn" onclick="closeModal('addEquipmentModal')">&times;</button>
      </div>
      <form id="addEquipmentForm">
        <label>
          <span>Equipment ID *</span>
          <input type="text" id="newEquipmentId" required placeholder="e.g. EQ-001" />
        </label>
        <label style="margin-top: 16px;">
          <span>Type *</span>
          <input type="text" id="newEquipmentType" required placeholder="e.g. Scanner, Printer" />
        </label>
        <label style="margin-top: 16px;">
          <span>Station *</span>
          <select id="newEquipmentStation" required>
            <option value="">Select Station</option>
          </select>
        </label>
        <label style="margin-top: 16px;">
          <span>Status</span>
          <select id="newEquipmentStatus">
            <option value="operational">Operational</option>
            <option value="maintenance">Maintenance</option>
            <option value="offline">Offline</option>
          </select>
        </label>
        <label style="margin-top: 16px;">
          <span>Last Service Date</span>
          <input type="date" id="newEquipmentLastService" />
        </label>
        <label style="margin-top: 16px;">
          <span>Notes</span>
          <textarea id="newEquipmentNotes" rows="3"></textarea>
        </label>
        <div class="modal-actions">
          <button type="button" class="btn" onclick="closeModal('addEquipmentModal')">Cancel</button>
          <button type="submit" class="btn primary">Add Equipment</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Equipment Modal -->
  <div id="editEquipmentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Edit Equipment</h3>
        <button class="close-btn" onclick="closeModal('editEquipmentModal')">&times;</button>
      </div>
      <form id="editEquipmentForm">
        <input type="hidden" id="editEquipmentDocId" />
        <label>
          <span>Equipment ID *</span>
          <input type="text" id="editEquipmentId" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Type *</span>
          <input type="text" id="editEquipmentType" required />
        </label>
        <label style="margin-top: 16px;">
          <span>Station *</span>
          <select id="editEquipmentStation" required>
            <option value="">Select Station</option>
          </select>
        </label>
        <label style="margin-top: 16px;">
          <span>Status</span>
          <select id="editEquipmentStatus">
            <option value="operational">Operational</option>
            <option value="maintenance">Maintenance</option>
            <option value="offline">Offline</option>
          </select>
        </label>
        <label style="margin-top: 16px;">
          <span>Last Service Date</span>
          <input type="date" id="editEquipmentLastService" />
        </label>
        <label style="margin-top: 16px;">
          <span>Notes</span>
          <textarea id="editEquipmentNotes" rows="3"></textarea>
        </label>
        <div class="modal-actions">
          <button type="button" class="btn" onclick="closeModal('editEquipmentModal')">Cancel</button>
          <button type="submit" class="btn primary">Save Changes</button>
        </div>
      </form>
    </div>
  </div>
  
  </div><!-- END #adminContent -->

  <script src="assets/js/site.js"></script>
</body>
</html>
